<div *ngIf="gameSessionObs | async as gameSession" xmlns="http://www.w3.org/1999/html" class="game-session">
  <div class="game-config-row">
    <!-- Game Settings Section -->
    <mat-card *ngIf="gameSession.gameSettings" class="game-settings">
      <mat-card-title>Game Settings</mat-card-title>
      <mat-card-content>
        <p>Proctor Type: {{ gameSession.gameSettings.proctorType }}</p>
        <p>Game Mode: {{ gameSession.gameSettings.gameMode }}</p>
        <p>Join Code: {{gameSession.joinCode}}</p>
        <button mat-raised-button color="primary" (click)="startMatch()">Start Match</button>
      </mat-card-content>
    </mat-card>

    <!-- Packet Information Section -->
    <mat-card class="packet-info">
      <mat-card-title>Packet Information</mat-card-title>
      <mat-card-content>
        <div *ngIf="gameSession.currentMatch.packet">
          <p>Packet ID: {{ gameSession.currentMatch.packet.id }}</p>
          <p>Packet Name: {{ gameSession.currentMatch.packet.name }}</p>
        </div>

        <!-- Button to Open Packet Search Modal -->
        <button mat-raised-button color="primary" (click)="openPacketSearch()">Search Packet</button>
      </mat-card-content>
    </mat-card>
  </div>

  <mat-card class="proctor-card">
    <mat-card-title>Proctor</mat-card-title>
    <mat-card-content>
      <div class="proctor-info" *ngIf="gameStateService.getProctor()?.name">
        <mat-icon>face</mat-icon>
        <p>{{ gameStateService.getProctor()?.name }}</p>
      </div>
      <button mat-raised-button color="primary" *ngIf="canBecomeProctor()" (click)="becomeProctor()">Become Proctor</button>
    </mat-card-content>
  </mat-card>

  <div class="teams-row">
    <!-- Teams Section -->
    <div class="teams-section" *ngIf="gameSession.teamList">
      <mat-card *ngFor="let team of gameSession.teamList" class="team-card">
        <mat-card-title>{{ team.teamName }}</mat-card-title>
        <mat-card-content>
          <div class="team-players">
            <div *ngFor="let player of team.teamPlayers" class="player-icon">
              <mat-icon>face</mat-icon>
              <div>{{ player.name }}</div>
            </div>
          </div>
          <button mat-raised-button color="primary" *ngIf="!gameStateService.isSelfOnTeam(team.teamId)" (click)="joinTeam(team)"
                  class="join-team">Join Team
          </button>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <mat-card class="spectators">
    <mat-card-title>Spectators</mat-card-title>
    <mat-card-content>
      <mat-list>
        <ng-container *ngFor="let player of gameSession.playerList">
          <mat-list-item *ngIf="player.playerMode == PlayerMode.SPECTATOR">
            <mat-icon>face</mat-icon>
            {{ player.name }}
          </mat-list-item>
        </ng-container>
      </mat-list>
      <button mat-raised-button color="primary" *ngIf="gameStateService.isSelfOnAnyTeam() || gameStateService.isSelfProctor()"
              (click)="switchToSpectate()">
        Spectate
      </button>
    </mat-card-content>
  </mat-card>
</div>
